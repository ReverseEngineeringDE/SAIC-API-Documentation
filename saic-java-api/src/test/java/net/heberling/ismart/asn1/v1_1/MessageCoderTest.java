package net.heberling.ismart.asn1.v1_1;

import net.heberling.ismart.asn1.v1_1.entity.APPUpgradeInfoReq;
import net.heberling.ismart.asn1.v1_1.entity.APPUpgradeInfoResp;
import net.heberling.ismart.asn1.v1_1.entity.AdvertiseResp;
import net.heberling.ismart.asn1.v1_1.entity.MPAppAttributeResp;
import net.heberling.ismart.asn1.v1_1.entity.MP_UserLoggingInReq;
import net.heberling.ismart.asn1.v1_1.entity.MP_UserLoggingInResp;
import net.heberling.ismart.asn1.v1_1.entity.MessageListReq;
import net.heberling.ismart.asn1.v1_1.entity.MessageListResp;
import org.bn.coders.IASN1PreparedElement;
import org.junit.jupiter.api.Test;

class MessageCoderTest extends net.heberling.ismart.asn1.AbstractMessageCoderTest {

    @Test
    void decodeEncodeRequest_5D6() {
        // https://tap-eu.soimt.com/TAP.Web/ota.mp
        decodeEncode(
                "0059111002A00082C6B11B319B4BB380808011A2B3C4D0D4C3B2A1911A2B3C4D091A2B3C4D080000000004028",
                new MessageCoder<>(IASN1PreparedElement.class));
    }

    @Test
    void decodeEncodeResponse_5D6() {
        decodeEncode(
                "00BD111004F00482EB162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C586B11B319B4BB381008091A2B3C4D0D4C3B2A1911A2B3C4D091A2B3C4D08000000680402800008005E3C74346FDD95D3164D9B8",
                new MessageCoder<>(MPAppAttributeResp.class));
    }

    @Test
    void decodeEncodeRequest_5D5() {
        // https://tap-eu.soimt.com/TAP.Web/ota.mp
        decodeEncode(
                "0065111002A00082C6B11AB19B4BB580808011A2B3C4D0D4C3B2A1911A2B3C4D091A2B3C4D08000000300402888C57315CD80",
                new MessageCoder<>(APPUpgradeInfoReq.class));
    }

    @Test
    void decodeEncodeResponse_5D5() {
        decodeEncode(
                "00A5111004F00482EB162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C586B11AB19B4BB581008091A2B3C4D0D4C3B2A1911A2B3C4D091A2B3C4D080000000804028000040",
                new MessageCoder<>(APPUpgradeInfoResp.class));
    }

    @Test
    void decodeEncodeRequest_5D7() {
        // https://tap-eu.soimt.com/TAP.Web/ota.mp
        decodeEncode(
                "0059111002A00082C6B11BB19B4BB980808011A2B3C4D0D4C3B2A1911A2B3C4D091A2B3C4D080000000004028",
                new MessageCoder<>(IASN1PreparedElement.class));
    }

    @Test
    void decodeEncodeResponse_5D7() {
        decodeEncode(
                "00A3111004F00482EB162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C586B11BB19B4BB981008091A2B3C4D0D4C3B2A1911A2B3C4D091A2B3C4D0800000000040280000",
                new MessageCoder<>(AdvertiseResp.class));
    }

    @Test
    void decodeEncodeRequest_501() {
        // https://tap-eu.soimt.com/TAP.Web/ota.mp
        decodeEncode(
                "01F5111005600882CB162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B161AB062C66DA9E4020200468ACF1343530ECA864468ACF1342468ACF1342000001440100A08BA65E7D18B266D2BAC30B162C586162C58B161858B162C30B162C587562C5860C2C58B162FD8B162C58B0C1858B162C58B162C58BF62C586162C58B162C58B0B6C306161858B161830B162C30B162C58B162C586162C58B162C58617EFD8B162C586162C58B162C30B162C30B161830B162C58B162C58B162C58B162C306161858B162C58B162C58B161858B162C58B162C586162C58B08D1A3CBD796FE1971E1E4",
                new MessageCoder<>(MP_UserLoggingInReq.class));
    }

    @Test
    void decodeEncodeResponse_501_not_registered() {
        // account not registered
        decodeEncode(
                "0139111009A00C82FB162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B162C58B161AB062C66DA9E4040202468ACF1343530ECA864468ACF1342468ACF1342000000000100A75460EAA34329030B1B1B7BAB73A1034B9903737BA103932B3B4B9BA32B932B2170",
                new MessageCoder<>(MP_UserLoggingInResp.class),
                "not_registered");
    }

    @Test
    void decodeEncodeResponse_501() {
        decodeEncode(
                "0915111007B00C82E60C183060C183060C183060C183060C183060C183060C183060C183060C183072C183060C183060E5CB972E6C39B161CD8B0C1CD860E5CB07362C397361CB97361CD8B16183972E5CD872E6C5872E5AB062C68D7068040202468ACF1343530ECA864468ACF1342468ACF13420000081A0100A00000F6C39B161CD8B0E56B9B0E5CAD72C18395B62C5872B5CD872E6C3960E5CD860E6C3972E6C39B161CD8B0E56B9B0E5CAD72C18395B62C5872B5CD872E6C3960E5CD860E6C3972E58DB94D1800FAC58B161CB960E5CD8B0C1CB972E5CAC5A0CA2506614D47169A8E6A408AD8CAC6E8E4D2C6164C19312D0931050D2F0A814115054933FADD876E575534F2CA83872CBCF9F5E59506DDFBB4F4DFCB4EECE839F9E7D32ED598F7E4CAEA5316EB3B61D9D72BA62EF761DB95D52CB9FAECC3C9061D3CB161CFCD663DF932BAA2C182CED87675CAE98BBDD876E5751B96FDDD16F3CB87A20C3A7962C39F9ACC7BF265754583159DB0ECEB95D3177BB0EDCAEA0E9E58B0E741CFBE9E98F42CC7BF265754583959DB0ECEB95D3177BB0EDCAEA9F5DC8296FDF99663DF932BAA6CDAACED87675CAE983BDD876E5754B2EDDFD32A0C7BF774E5BF62CC7BF265754DB3159DB0ECEB95D3177BB0EDCAEA0E9E4831EFDD934F4D3BF769DD9D663DF932BAA8C58ACED87675CAE98BBDD876E57517665C7D3969C68286FEF97920A7D32E5E5A7767598F7E4CAEA2D0A6B3B61D9D72BA62EF761DB95D53CB8FAF2D3D3CA0C3B32F2E8B31EFC995D5382D9A2CED87675CAE983162C58B160C183060C183060C183062C183060C183160C18B062C183060C183062C18B060C183060C183060C183060C183060C183162C1DEEC3B72BA85BF76EEBD1053E987A75E6B31EFC995D429F3A755A8B3B61D9D72BA62EF761DB95D44DFBF920A7D30F4EBCD663DF932BA893E7D259DB0ECEB95D3162C58BBDD876E5750B7EFE8829F4C3D3AF3598F7E4CAEA14F9F51676C3B3AE574C5DEEC3B72BA8BBB3E9DD95053E987A75E6B31EFC995D459D1E4CE8AB3B61D9D72BA62EF761DB95D45D9971F4E5A71A0AD97469C7B32ACC7BF2657516B2CED87675CAE983BDD876E575232E1E997253CB87A2CC7BF26575232E1E997253CB87A2CED87675CAE983BDD876E5752F2F941437F3D3D34EFDCB31EFC995D4B8B6684FA6B3B61D9D72BA62EF761DB95D45DD97967F2839F4C3D32ACC7BF2657516745A51ECACED87675CAE983BDD876E5750B0F4E997979415B7ECE9873E5598F7E4CAEA141A9522D2B2B3B61D9D72BA62EF761DB95D49DDD32F2D3BF920A9976F0CBCB0F4EBCB2ACC7BF26575267548B3682CED87675CAE98BBDD876E57517C74CBCB4EFE482A65DBC32F2C3D3AF2CAB31EFC995D45B1522CDA0B3B61D9D72BA62EF761DB95D57D3BB26FEE829F4C3D3AF3598F7E4CAEABC99D127D759DB0ECEB95D3060C183BDD876E575332E6E8B6969CFA3A2089CB4F6D3BB3ACC7BF265753294459DB0ECEB95D3077BB0EDCAEA16CEB97A6FDFD34209797CACC7BF265750AA4B8B65676C3B3AE574C1DEEC3B72BA8587A74CBCBCA0A9E7865598F7E4CAEA154F3C32ACED87675CAE993191A023A62C99B46AD9BB872C060",
                new MessageCoder<>(MP_UserLoggingInResp.class));
    }
}
